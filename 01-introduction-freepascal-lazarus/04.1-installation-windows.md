üîù Retour au [Sommaire](/SOMMAIRE.md)

# 1.4.1 Installation sur Windows (installer, chocolatey, portable)

## Introduction : Windows et le d√©veloppement Pascal

### Pourquoi Windows reste important

Malgr√© la mont√©e de Linux et macOS dans le d√©veloppement, Windows reste la plateforme desktop dominante :
- **90%** des postes en entreprise
- **75%** des PC personnels
- **100%** de compatibilit√© avec l'h√©ritage Delphi
- √âcosyst√®me de composants le plus riche

Pour un d√©veloppeur FreePascal/Lazarus, Windows offre :
- La meilleure compatibilit√© avec le code Delphi existant
- L'acc√®s √† l'API Win32/Win64 native
- Le support de tous les composants commerciaux
- L'int√©gration avec l'√©cosyst√®me Microsoft

### Les trois m√©thodes d'installation

Sur Windows, vous avez trois approches principales :

1. **Installation classique** : La m√©thode traditionnelle avec un installateur graphique
2. **Chocolatey** : Le gestionnaire de paquets moderne pour Windows
3. **Version portable** : Sans installation, depuis une cl√© USB ou un dossier

Chacune a ses avantages selon votre situation. Explorons-les en d√©tail.

## M√©thode 1 : Installation classique avec l'installateur

### T√©l√©chargement de l'installateur

#### √âtape 1 : Acc√©der au site officiel

Rendez-vous sur **https://www.lazarus-ide.org**

Sur la page d'accueil, vous verrez g√©n√©ralement :
- Un gros bouton "Download Now"
- La derni√®re version stable mise en avant
- Des liens vers les versions de d√©veloppement

#### √âtape 2 : Choisir la bonne version

**Pour Windows 64 bits moderne (recommand√©)** :
- Fichier : `lazarus-3.0.0-fpc-3.2.2-win64.exe`
- Taille : environ 200 MB
- Contient : Lazarus + FPC + Sources

**Pour Windows 32 bits ou compatibilit√© maximale** :
- Fichier : `lazarus-3.0.0-fpc-3.2.2-win32.exe`
- Taille : environ 180 MB
- Fonctionne sur : Windows XP et plus

**Pour installation avec cross-compilation** :
- Fichier : `lazarus-3.0.0-fpc-3.2.2-cross-x86_64-win64-win32.exe`
- Permet de compiler en 32 et 64 bits
- Taille : environ 400 MB

#### √âtape 3 : V√©rifier l'int√©grit√© (recommand√©)

Apr√®s t√©l√©chargement, v√©rifiez le checksum :

1. T√©l√©chargez le fichier `.md5` ou `.sha256` correspondant
2. Ouvrez PowerShell dans le dossier de t√©l√©chargement
3. Tapez :
```powershell
# Pour MD5
Get-FileHash -Algorithm MD5 lazarus-3.0.0-fpc-3.2.2-win64.exe

# Pour SHA256
Get-FileHash -Algorithm SHA256 lazarus-3.0.0-fpc-3.2.2-win64.exe
```
4. Comparez avec la valeur du fichier t√©l√©charg√©

### Processus d'installation pas √† pas

#### √âtape 1 : Lancer l'installateur

Double-cliquez sur le fichier `.exe` t√©l√©charg√©.

**Si Windows Defender SmartScreen appara√Æt** :
- Cliquez sur "Informations compl√©mentaires"
- Puis "Ex√©cuter quand m√™me"
- C'est normal, Lazarus n'est pas sign√© avec un certificat commercial co√ªteux

#### √âtape 2 : Choix de la langue

L'installateur propose plusieurs langues :
- English (par d√©faut)
- Fran√ßais
- Deutsch
- Espa√±ol
- Et beaucoup d'autres

S√©lectionnez votre langue pr√©f√©r√©e.

#### √âtape 3 : √âcran de bienvenue

L'installateur affiche :
- La version √† installer
- Un avertissement de fermer les autres programmes
- Les notes de version (Release Notes)

**Important** : Fermez vraiment les autres programmes, surtout :
- Les IDE (Visual Studio, Delphi, etc.)
- Les antivirus temps r√©el (ou ajoutez une exception)
- Les anciennes versions de Lazarus

#### √âtape 4 : Contrat de licence

Lazarus est distribu√© sous licences :
- **GPL** pour l'IDE lui-m√™me
- **LGPL modifi√©e** pour la LCL et RTL

Ce qui signifie :
- ‚úÖ Vous pouvez cr√©er des applications commerciales
- ‚úÖ Vous n'avez pas √† publier le code de VOS applications
- ‚úÖ Modifications de Lazarus lui-m√™me = partage obligatoire

#### √âtape 5 : Choix du r√©pertoire d'installation

**R√©pertoire par d√©faut** :
- 64 bits : `C:\lazarus`
- 32 bits : `C:\lazarus`

**Recommandations** :
- ‚úÖ Gardez le chemin court et simple
- ‚úÖ √âvitez les espaces si possible
- ‚úÖ √âvitez "Program Files" (probl√®mes de permissions)
- ‚ùå Mauvais : `C:\Program Files\Mon Dossier Lazarus\`
- ‚úÖ Bon : `C:\lazarus\` ou `D:\dev\lazarus\`

**Si vous avez plusieurs versions** :
- `C:\lazarus30\` pour la version 3.0
- `C:\lazarus22\` pour la version 2.2
- Etc.

#### √âtape 6 : S√©lection des composants

L'installateur propose plusieurs options :

```
[x] Lazarus IDE
    L'environnement de d√©veloppement principal

[x] FreePascal compiler
    Le compilateur FPC

[x] FreePascal sources
    Sources du compilateur (recommand√© pour d√©bogage profond)

[x] FreePascal documentation
    Documentation CHM hors ligne

[x] Lazarus sources
    Sources de l'IDE (obligatoire pour recompiler l'IDE)

[ ] Register file associations
    Associer .pas .pp .lpr .lpk √† Lazarus
```

**Pour une installation standard** : Gardez tout coch√© sauf associations (si vous avez Delphi).

**Pour √©conomiser l'espace** : D√©cochez "FreePascal sources" (√©conomise ~500 MB).

#### √âtape 7 : Menu D√©marrer

Choisissez le nom du dossier dans le menu D√©marrer :
- Par d√©faut : "Lazarus"
- Si plusieurs versions : "Lazarus 3.0", "Lazarus 2.2", etc.

#### √âtape 8 : Options suppl√©mentaires

```
[x] Create Desktop Icon
    Ic√¥ne sur le bureau

[x] Create Quick Launch Icon
    Ic√¥ne dans la barre de lancement rapide
```

Cochez selon vos pr√©f√©rences.

#### √âtape 9 : Installation

L'installateur :
1. Copie les fichiers (2-5 minutes)
2. Configure les chemins
3. Enregistre dans le registre
4. Cr√©e les raccourcis

**Barre de progression** montre :
- Fichier en cours de copie
- Pourcentage global
- Temps restant estim√©

#### √âtape 10 : Finalisation

Options finales :
```
[x] Launch Lazarus
    D√©marrer Lazarus imm√©diatement

[x] View README
    Afficher le fichier README
```

Cliquez sur "Terminer".

### Premier lancement et configuration initiale

#### Premier d√©marrage

Au premier lancement, Lazarus :
1. D√©tecte le compilateur FPC
2. V√©rifie les sources
3. Configure les chemins
4. Compile les outils de base

**Si une erreur appara√Æt** :
- "FPC not found" : R√©installez avec FPC inclus
- "Sources not found" : Normal si non install√©es
- "GDB not found" : Le d√©bogueur sera configur√© apr√®s

#### Configuration initiale de l'IDE

**Fen√™tre de configuration** au premier lancement :

1. **Langue de l'interface** :
   - Fran√ßais disponible
   - Red√©marrage n√©cessaire

2. **Th√®me de couleur** :
   - Default (clair)
   - Dark (sombre)
   - Custom (personnalis√©)

3. **Layout des fen√™tres** :
   - Classic (fen√™tres s√©par√©es)
   - Anchored (fen√™tres ancr√©es)
   - Modern (style Delphi r√©cent)

#### V√©rification de l'installation

Pour v√©rifier que tout fonctionne :

1. **Cr√©er un projet test** :
   - Fichier ‚Üí Nouveau ‚Üí Projet ‚Üí Application
   - Sauvegardez dans un dossier test

2. **Ajouter un bouton** :
   - Dans la palette Standard, cliquez sur TButton
   - Cliquez sur le formulaire pour placer le bouton

3. **Ajouter du code** :
   - Double-cliquez sur le bouton
   - Ajoutez : `ShowMessage('Hello Lazarus!');`

4. **Compiler et ex√©cuter** :
   - Appuyez sur F9 ou Ex√©cuter ‚Üí Ex√©cuter
   - Une fen√™tre avec votre bouton doit appara√Ætre

### Configuration post-installation

#### Optimisation des chemins

V√©rifiez dans **Outils ‚Üí Options** :

**Environnement ‚Üí Fichiers** :
- R√©pertoire Lazarus : `C:\lazarus`
- R√©pertoire FPC : `C:\lazarus\fpc\3.2.2`
- Sources FPC : `C:\lazarus\fpc\3.2.2\source`
- Make : `C:\lazarus\fpc\3.2.2\bin\x86_64-win64\make.exe`

**Environnement ‚Üí R√©pertoires de sauvegarde** :
- Projet : `backup\`
- Autres fichiers : `backup\`

#### Configuration du d√©bogueur

**Outils ‚Üí Options ‚Üí D√©bogueur** :

1. **Type de d√©bogueur** :
   - GDB (GNU Debugger) - par d√©faut
   - FpDebug - nouveau, exp√©rimental mais prometteur

2. **Chemin GDB** :
   - 64 bits : `C:\lazarus\mingw\x86_64-win64\bin\gdb.exe`
   - 32 bits : `C:\lazarus\mingw\i386-win32\bin\gdb.exe`

3. **Options GDB recommand√©es** :
   ```
   [x] Reset after each run
   [x] Show message on stop
   [ ] Disable startup shell (cocher si probl√®mes)
   ```

#### Ajout au PATH syst√®me (optionnel)

Pour utiliser FPC en ligne de commande :

1. **Ouvrir les variables d'environnement** :
   - Clic droit sur "Ce PC" ‚Üí Propri√©t√©s
   - Param√®tres syst√®me avanc√©s
   - Variables d'environnement

2. **Modifier la variable PATH** :
   - Dans "Variables syst√®me", trouvez PATH
   - Modifier ‚Üí Nouveau
   - Ajouter : `C:\lazarus\fpc\3.2.2\bin\x86_64-win64`

3. **V√©rifier** dans un nouveau cmd :
   ```cmd
   fpc -v
   ```
   Devrait afficher la version de FPC.

## M√©thode 2 : Installation via Chocolatey

### Qu'est-ce que Chocolatey ?

**Chocolatey** est le gestionnaire de paquets pour Windows, similaire √† :
- `apt` sur Ubuntu/Debian
- `brew` sur macOS
- `yum` sur RedHat/CentOS

**Avantages** :
- Installation en une commande
- Mises √† jour automatiques
- Gestion des d√©pendances
- Int√©gration scripts/CI

**Inconv√©nients** :
- N√©cessite PowerShell admin
- Versions parfois en retard
- Moins de contr√¥le sur l'installation

### Installation de Chocolatey

#### Pr√©requis

- Windows 7+ / Windows Server 2003+
- PowerShell v2+ (v5+ recommand√©)
- .NET Framework 4+

#### Installation de Chocolatey lui-m√™me

1. **Ouvrir PowerShell en administrateur** :
   - Windows + X ‚Üí Windows PowerShell (Admin)
   - Ou rechercher "PowerShell" ‚Üí Clic droit ‚Üí Administrateur

2. **V√©rifier la politique d'ex√©cution** :
   ```powershell
   Get-ExecutionPolicy
   ```
   Si "Restricted", changez temporairement :
   ```powershell
   Set-ExecutionPolicy Bypass -Scope Process
   ```

3. **Installer Chocolatey** :
   ```powershell
   Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
   ```

4. **V√©rifier l'installation** :
   ```powershell
   choco -v
   ```

### Installation de Lazarus via Chocolatey

#### Installation simple

Dans PowerShell administrateur :

```powershell
choco install lazarus
```

Chocolatey va :
1. T√©l√©charger Lazarus et FPC
2. Installer silencieusement
3. Configurer les variables d'environnement
4. Cr√©er les raccourcis

**Options utiles** :

```powershell
# Installation sans confirmation
choco install lazarus -y

# Installation d'une version sp√©cifique
choco install lazarus --version=2.2.6

# Installation avec param√®tres
choco install lazarus --install-arguments="'/DIR=C:\tools\lazarus'"

# Voir les versions disponibles
choco search lazarus --all-versions
```

#### Gestion des paquets

**Mise √† jour** :
```powershell
# Mettre √† jour Lazarus
choco upgrade lazarus

# Mettre √† jour tous les paquets
choco upgrade all
```

**D√©sinstallation** :
```powershell
choco uninstall lazarus
```

**Information** :
```powershell
# Voir les paquets install√©s
choco list --local-only

# Informations sur Lazarus
choco info lazarus
```

### Configuration Chocolatey pour entreprise

#### Utilisation d'un proxy

Si vous √™tes derri√®re un proxy d'entreprise :

```powershell
# Configuration du proxy
choco config set proxy http://proxy.company.com:8080  
choco config set proxyUser monuser  
choco config set proxyPassword monpass

# V√©rification
choco config list
```

#### Cr√©ation d'un repository interne

Pour une entreprise, cr√©er un repo Chocolatey interne :

1. **Serveur de packages** :
   ```powershell
   # Installer Chocolatey Server
   choco install chocolatey.server
   ```

2. **Pousser Lazarus** :
   ```powershell
   # T√©l√©charger le package
   choco download lazarus --source=https://community.chocolatey.org/api/v2/

   # Pousser vers repo interne
   choco push lazarus.3.0.0.nupkg --source=http://internal-repo
   ```

3. **Utiliser le repo interne** :
   ```powershell
   choco source add -n=internal -s=http://internal-repo
   choco install lazarus --source=internal
   ```

## M√©thode 3 : Version portable

### Avantages de la version portable

La version portable est id√©ale pour :
- **Cl√©s USB** : D√©veloppement nomade
- **Environnements restreints** : Sans droits admin
- **Tests** : Multiples versions c√¥te √† c√¥te
- **Formations** : Distribution facile aux √©tudiants
- **CI/CD** : Int√©gration dans pipelines

### Cr√©ation d'une installation portable

#### M√©thode 1 : Archive ZIP officielle

1. **T√©l√©charger l'archive** :
   - Sur SourceForge ou le site officiel
   - Chercher : `lazarus-3.0.0-fpc-3.2.2-win64.zip`
   - Taille : environ 500 MB

2. **Extraire** :
   ```
   D:\Portable\
   ‚îî‚îÄ‚îÄ Lazarus\
       ‚îú‚îÄ‚îÄ fpc\
       ‚îú‚îÄ‚îÄ ide\
       ‚îú‚îÄ‚îÄ components\
       ‚îî‚îÄ‚îÄ config\
   ```

3. **Configuration initiale** :
   - Lancer `lazarus.exe`
   - L'IDE cr√©era sa config dans le dossier

#### M√©thode 2 : Cr√©ation manuelle depuis installation

1. **Installer normalement** sur un PC

2. **Copier le dossier entier** :
   - Source : `C:\lazarus\`
   - Destination : `E:\LazarusPortable\`

3. **Nettoyer les r√©f√©rences absolues** :
   - √âditer `lazarus.cfg`
   - Remplacer les chemins absolus par relatifs

4. **Cr√©er un launcher** :
   Cr√©er `StartLazarus.bat` :
   ```batch
   @echo off
   set LAZARUS_DIR=%~dp0
   set FPC_DIR=%LAZARUS_DIR%\fpc\3.2.2
   set PATH=%FPC_DIR%\bin\x86_64-win64;%PATH%

   cd /d "%LAZARUS_DIR%"
   start lazarus.exe --pcp=config
   ```

### Configuration de la version portable

#### Structure recommand√©e

```
LazarusPortable\
‚îú‚îÄ‚îÄ Lazarus\              # Fichiers Lazarus/FPC
‚îÇ   ‚îú‚îÄ‚îÄ fpc\
‚îÇ   ‚îú‚îÄ‚îÄ ide\
‚îÇ   ‚îî‚îÄ‚îÄ components\
‚îú‚îÄ‚îÄ Config\               # Configuration portable
‚îÇ   ‚îú‚îÄ‚îÄ lazarus\         # Config IDE
‚îÇ   ‚îî‚îÄ‚îÄ fpc\            # Config compilateur
‚îú‚îÄ‚îÄ Projects\            # Vos projets
‚îÇ   ‚îú‚îÄ‚îÄ Project1\
‚îÇ   ‚îî‚îÄ‚îÄ Project2\
‚îú‚îÄ‚îÄ Packages\            # Packages additionnels
‚îî‚îÄ‚îÄ StartLazarus.bat     # Lanceur
```

#### Fichier de configuration portable

Cr√©er `lazarus.cfg` dans le r√©pertoire Lazarus :
```ini
# Chemins relatifs
--primary-config-path=..\Config\lazarus
--lazarus-dir=.
--fpc-dir=fpc\3.2.2
--fpc-source=fpc\3.2.2\source
```

#### Script de lancement avanc√©

`StartLazarus.bat` am√©lior√© :
```batch
@echo off
setlocal EnableDelayedExpansion

:: D√©tection du r√©pertoire portable
set PORTABLE_DIR=%~dp0  
set LAZARUS_DIR=%PORTABLE_DIR%Lazarus  
set CONFIG_DIR=%PORTABLE_DIR%Config  
set PROJECT_DIR=%PORTABLE_DIR%Projects

:: V√©rification de l'existence
if not exist "%LAZARUS_DIR%\lazarus.exe" (
    echo Erreur: Lazarus.exe non trouv√©!
    pause
    exit /b 1
)

:: Configuration environnement
set FPC_DIR=%LAZARUS_DIR%\fpc\3.2.2  
set PATH=%FPC_DIR%\bin\x86_64-win64;%PATH%

:: Cr√©ation des dossiers si n√©cessaire
if not exist "%CONFIG_DIR%" mkdir "%CONFIG_DIR%"  
if not exist "%PROJECT_DIR%" mkdir "%PROJECT_DIR%"

:: D√©tection version Windows
for /f "tokens=4-5 delims=. " %%i in ('ver') do set VERSION=%%i.%%j

:: Message de bienvenue
cls  
echo ===============================================  
echo    Lazarus Portable - Version 3.0.0  
echo    FPC Version: 3.2.2  
echo    Windows Version: %VERSION%  
echo    R√©pertoire: %PORTABLE_DIR%  
echo ===============================================  
echo.  
echo D√©marrage de Lazarus...  
echo.

:: Lancement avec config portable
cd /d "%LAZARUS_DIR%"  
start "" lazarus.exe --pcp="%CONFIG_DIR%\lazarus"

:: Option : Ouvrir l'explorateur dans Projects
:: start "" explorer "%PROJECT_DIR%"
```

### Utilisation sur cl√© USB

#### Pr√©paration de la cl√©

1. **Formater en NTFS** (recommand√©) ou exFAT :
   - NTFS : Supporte fichiers >4GB, permissions
   - exFAT : Compatible Mac/Linux mais moins fiable

2. **Structure optimale** :
   ```
   E:\ (Cl√© USB)
   ‚îú‚îÄ‚îÄ LazarusPortable\
   ‚îú‚îÄ‚îÄ Projects\
   ‚îú‚îÄ‚îÄ Backup\
   ‚îî‚îÄ‚îÄ Documentation\
   ```

3. **Optimisations performance** :
   - D√©sactiver l'indexation Windows
   - D√©sactiver l'antivirus temps r√©el sur la cl√©
   - Utiliser USB 3.0+ si possible

#### Gestion des lettres de lecteur

Probl√®me : La lettre change selon le PC (E:, F:, G:...)

**Solution 1 : Chemins relatifs partout**
```batch
:: Dans les scripts, utiliser %~d0 pour la lettre
set USB_DRIVE=%~d0  
set LAZARUS_PATH=%USB_DRIVE%\LazarusPortable
```

**Solution 2 : Assigner une lettre fixe**
```batch
:: AssignDrive.bat
@echo off
:: Tente d'assigner la lettre L: √† la cl√©
set TARGET_LETTER=L:

:: Trouve la lettre actuelle
for %%D in (D: E: F: G: H: I: J: K:) do (
    if exist "%%D\LazarusPortable\lazarus.exe" (
        echo Trouv√© sur %%D
        subst %TARGET_LETTER% "%%D\LazarusPortable"
        echo Assign√© √† %TARGET_LETTER%
        goto :end
    )
)
:end
```

### Synchronisation et backup

#### Synchronisation entre machines

**Script de synchronisation** `SyncProjects.bat` :
```batch
@echo off
echo Synchronisation des projets...

:: Variables
set SOURCE=%~dp0Projects  
set BACKUP=%~dp0Backup\%DATE:~6,4%%DATE:~3,2%%DATE:~0,2%

:: Backup avant sync
echo Cr√©ation backup dans %BACKUP%  
xcopy "%SOURCE%" "%BACKUP%" /E /I /Y

:: Sync avec OneDrive/Dropbox/Google Drive
set CLOUD=C:\Users\%USERNAME%\OneDrive\LazarusProjects  
if exist "%CLOUD%" (
    echo Synchronisation avec OneDrive...
    xcopy "%SOURCE%" "%CLOUD%" /E /Y /D
    xcopy "%CLOUD%" "%SOURCE%" /E /Y /D
)

echo Synchronisation termin√©e!  
pause
```

#### Backup automatique

Script `AutoBackup.bat` √† lancer r√©guli√®rement :
```batch
@echo off
setlocal EnableDelayedExpansion

:: Configuration
set SOURCE_DIR=%~dp0Projects  
set BACKUP_DIR=%~dp0Backup  
set MAX_BACKUPS=10

:: Cr√©ation nom unique avec timestamp
for /f "tokens=2 delims==" %%I in ('wmic os get localdatetime /value') do set datetime=%%I  
set TIMESTAMP=%datetime:~0,8%_%datetime:~8,6%  
set BACKUP_NAME=Backup_%TIMESTAMP%

:: Cr√©ation du backup
echo Cr√©ation backup: %BACKUP_NAME%  
xcopy "%SOURCE_DIR%" "%BACKUP_DIR%\%BACKUP_NAME%" /E /I /Y

:: Nettoyage vieux backups (garde les 10 derniers)
set count=0  
for /f "delims=" %%D in ('dir "%BACKUP_DIR%" /B /AD /O-D') do (
    set /a count+=1
    if !count! GTR %MAX_BACKUPS% (
        echo Suppression ancien backup: %%D
        rd /S /Q "%BACKUP_DIR%\%%D"
    )
)

echo Backup termin√©!
```

### Int√©gration avec l'explorateur Windows

#### Menu contextuel pour fichiers Pascal

Cr√©er `AddContextMenu.reg` :
```registry
Windows Registry Editor Version 5.00

; Menu pour fichiers .pas
[HKEY_CURRENT_USER\Software\Classes\.pas\shell\OpenWithLazarusPortable]
@="Ouvrir avec Lazarus Portable"
"Icon"="E:\\LazarusPortable\\Lazarus\\lazarus.exe,0"

[HKEY_CURRENT_USER\Software\Classes\.pas\shell\OpenWithLazarusPortable\command]
@="\"E:\\LazarusPortable\\Lazarus\\lazarus.exe\" \"%1\""

; Menu pour fichiers .lpr (projets)
[HKEY_CURRENT_USER\Software\Classes\.lpr\shell\OpenWithLazarusPortable]
@="Ouvrir projet avec Lazarus Portable"
"Icon"="E:\\LazarusPortable\\Lazarus\\lazarus.exe,0"

[HKEY_CURRENT_USER\Software\Classes\.lpr\shell\OpenWithLazarusPortable\command]
@="\"E:\\LazarusPortable\\Lazarus\\lazarus.exe\" \"%1\""
```

**Note** : Adaptez les chemins selon votre installation.

## Comparaison des trois m√©thodes

### Tableau comparatif

| Crit√®re | Installateur | Chocolatey | Portable |
|---------|--------------|------------|----------|
| **Difficult√©** | Facile | Moyenne | Moyenne |
| **Droits admin** | Requis | Requis | Non requis |
| **Temps installation** | 5-10 min | 5-10 min | 2 min |
| **Mise √† jour** | Manuelle | Automatique | Manuelle |
| **Multi-versions** | Complexe | Possible | Facile |
| **Int√©gration syst√®me** | Compl√®te | Compl√®te | Limit√©e |
| **Taille disque** | 1-2 GB | 1-2 GB | 500 MB-1 GB |
| **Mobilit√©** | Non | Non | Oui |
| **CI/CD** | Possible | Excellent | Excellent |
| **Support** | Officiel | Communaut√© | DIY |

### Recommandations par profil

#### D√©veloppeur d√©butant
**‚Üí Installateur classique**
- Plus simple et guid√©
- Documentation abondante
- Support communautaire direct

#### D√©veloppeur en entreprise
**‚Üí Chocolatey**
- Gestion centralis√©e
- Mises √† jour automatiques
- Scripts de d√©ploiement

#### D√©veloppeur nomade
**‚Üí Version portable**
- Sur cl√© USB
- Multiples machines
- Pas de traces

#### Formateur/Enseignant
**‚Üí Version portable**
- Distribution facile
- Pas de droits admin √©tudiants
- Versions multiples

#### DevOps/CI
**‚Üí Chocolatey ou Portable**
- Automatisation compl√®te
- Reproductibilit√©
- Conteneurisation

## D√©pannage des probl√®mes courants

### Probl√®mes d'installation

#### "This app can't run on your PC"
**Cause** : Architecture incorrecte (32/64 bits)  
**Solution** : T√©l√©charger la version correspondant √† votre Windows  

#### "Access Denied" pendant l'installation
**Cause** : Droits insuffisants ou antivirus  
**Solutions** :  
1. Lancer en tant qu'administrateur
2. D√©sactiver temporairement l'antivirus
3. Installer dans un dossier non prot√©g√©

#### Installation bloqu√©e √† X%
**Causes possibles** :
- Antivirus scanne les fichiers
- Espace disque insuffisant
- Fichier corrompu

**Solutions** :
1. Patience (peut prendre 30 min avec antivirus)
2. V√©rifier espace disque
3. Re-t√©l√©charger et v√©rifier checksum

### Probl√®mes au premier lancement

#### "Cannot find FPC executable"
**Cause** : FPC non install√© ou mal configur√©  
**Solution** :  
1. Outils ‚Üí Options ‚Üí Environnement ‚Üí Fichiers
2. Compiler ‚Üí Chemin du compilateur
3. Pointer vers : `C:\lazarus\fpc\3.2.2\bin\x86_64-win64\fpc.exe`

#### "Debugger not found"
**Cause** : GDB non install√©  
**Solution** :  
1. T√©l√©charger GDB pour Windows
2. Extraire dans `C:\lazarus\mingw\`
3. Configurer dans Options ‚Üí D√©bogueur

#### Fen√™tres IDE dispers√©es/perdues
**Solution** :
1. Fen√™tre ‚Üí Position par d√©faut
2. Ou supprimer `%APPDATA%\lazarus\`
3. Red√©marrer Lazarus

### Probl√®mes de compilation

#### "Can't call the linker"
**Causes** :
- Antivirus bloque ld.exe
- PATH incorrect
- Fichiers binutils manquants

**Solutions** :
1. Exception antivirus pour `C:\lazarus\`
2. V√©rifier PATH syst√®me
3. R√©installer avec tous les composants

#### Compilation tr√®s lente
**Optimisations** :
1. Exclure dossier Lazarus de l'antivirus
2. D√©sactiver Windows Defender temps r√©el
3. Utiliser SSD si possible
4. Fermer autres applications

### Probl√®mes avec Windows sp√©cifiques

#### Windows 11 et s√©curit√© renforc√©e
Windows 11 est plus strict :
1. Smart App Control peut bloquer
2. Solution : Param√®tres ‚Üí Confidentialit√© ‚Üí Windows Security ‚Üí App & browser control ‚Üí D√©sactiver Smart App Control

#### Compatibilit√© Windows XP/Vista
Pour supporter ces vieux OS :
1. Utiliser Lazarus 2.0.x maximum
2. FPC 3.2.0 maximum
3. Installer Visual C++ 2008 Redistributable

## Conseils et bonnes pratiques

### Organisation des projets

**Structure recommand√©e** :
```
C:\Dev\
‚îú‚îÄ‚îÄ Lazarus\          # Installation(s) Lazarus
‚îú‚îÄ‚îÄ Projects\         # Vos projets
‚îÇ   ‚îú‚îÄ‚îÄ Personnel\
‚îÇ   ‚îú‚îÄ‚îÄ Client1\
‚îÇ   ‚îî‚îÄ‚îÄ Tests\
‚îú‚îÄ‚îÄ Components\       # Composants tiers
‚îú‚îÄ‚îÄ Tools\           # Outils (Git, etc.)
‚îî‚îÄ‚îÄ Docs\            # Documentation
```

### S√©curit√© et antivirus

**Configuration antivirus optimale** :

1. **Exclusions √† ajouter** :
   - `C:\lazarus\` (dossier complet)
   - `C:\Dev\Projects\` (vos projets)
   - `*.exe` dans vos dossiers de compilation
   - Processus : `fpc.exe`, `lazarus.exe`, `gdb.exe`

2. **Windows Defender** :
   ```powershell
   # Ajouter exclusions via PowerShell (admin)
   Add-MpPreference -ExclusionPath "C:\lazarus"
   Add-MpPreference -ExclusionPath "C:\Dev\Projects"
   Add-MpPreference -ExclusionProcess "fpc.exe"
   Add-MpPreference -ExclusionProcess "lazarus.exe"
   ```

3. **Impact sur les performances** :
   - Sans exclusion : Compilation 10x plus lente
   - Avec exclusion : Performance normale
   - Risque s√©curit√© : Minimal si vous compilez votre propre code

### Gestion des versions multiples

#### Installation c√¥te √† c√¥te

Pour avoir plusieurs versions de Lazarus :

1. **M√©thode dossiers s√©par√©s** :
   ```
   C:\
   ‚îú‚îÄ‚îÄ lazarus30\     # Version 3.0
   ‚îú‚îÄ‚îÄ lazarus22\     # Version 2.2
   ‚îî‚îÄ‚îÄ lazarus_trunk\ # Version d√©veloppement
   ```

2. **Script de s√©lection** `SelectLazarus.bat` :
   ```batch
   @echo off
   echo S√©lection version Lazarus
   echo 1. Lazarus 3.0 (Stable)
   echo 2. Lazarus 2.2 (Legacy)
   echo 3. Lazarus Trunk (Dev)

   choice /c 123 /n /m "Choix: "

   if %errorlevel%==1 start C:\lazarus30\lazarus.exe
   if %errorlevel%==2 start C:\lazarus22\lazarus.exe
   if %errorlevel%==3 start C:\lazarus_trunk\lazarus.exe
   ```

3. **Configuration s√©par√©e** :
   - Chaque version a son `--pcp` (primary config path)
   - Exemple : `lazarus.exe --pcp=C:\LazConfigs\v30`

#### Migration de projets entre versions

**Check-list de migration** :
- [ ] Backup du projet complet
- [ ] Ouvrir avec nouvelle version
- [ ] Recompiler tous les packages
- [ ] Tester fonctionnalit√©s critiques
- [ ] Mettre √† jour le fichier `.lpi` si n√©cessaire

### Int√©gration avec les outils de d√©veloppement

#### Git pour Windows

**Configuration `.gitignore` pour projets Lazarus** :
```gitignore
# Lazarus / FreePascal
*.compiled
*.ppu
*.o
*.or
*.a
*.rsj
*.lps
*.bak*
backup/  
lib/

# Ex√©cutables Windows
*.exe
*.dll

# Fichiers temporaires
*.tmp
*~

# Configuration locale
*.local
*.cfg

# Mais garder
!*.lpr
!*.pas
!*.lfm
!*.lpi
!*.lpk
```

#### Visual Studio Code comme √©diteur externe

1. **Installer l'extension Pascal** :
   - Ouvrir VS Code
   - Extensions ‚Üí Rechercher "Pascal"
   - Installer "Pascal" ou "OmniPascal"

2. **Configuration pour Lazarus** :
   ```json
   {
     "pascal.formatter.engine": "ptop",
     "pascal.formatter.enginePath": "C:\\lazarus\\fpc\\3.2.2\\bin\\x86_64-win64\\ptop.exe",
     "pascal.compile.commandLine": "C:\\lazarus\\fpc\\3.2.2\\bin\\x86_64-win64\\fpc.exe",
     "pascal.languageServer.path": "C:\\lazarus\\components\\pasls\\pasls.exe"
   }
   ```

### Performance et optimisation

#### Acc√©l√©ration de la compilation

1. **Utiliser un RAM Disk** :
   - Installer ImDisk ou similaire
   - Cr√©er disque RAM de 2-4 GB
   - Compiler vers le RAM disk
   - 3-5x plus rapide

2. **Compilation parall√®le** :
   ```
   Projet ‚Üí Options ‚Üí Compilation
   [x] Use parallel compilation
   Processes: [4] (selon CPU)
   ```

3. **Cache des unit√©s** :
   - Conserver les `.ppu` et `.o`
   - Ne recompiler que le modifi√©
   - Gain : 50-80% du temps

#### Optimisation de l'IDE

**D√©sactiver les fonctionnalit√©s inutiles** :
- Code Explorer si non utilis√©
- Code Browser si projet simple
- Packages non essentiels

**Ajuster les param√®tres m√©moire** :
Dans `lazarus.cfg` :
```
-Xs  # Strip symbols
-CX  # Smartlink
-XX  # Link smart
-O3  # Optimisation niveau 3
```

### D√©ploiement d'applications

#### Cr√©ation d'un installateur Windows

**Avec Inno Setup** (recommand√©) :

1. **Installer Inno Setup** :
   ```powershell
   choco install innosetup
   ```

2. **Script exemple** `setup.iss` :
   ```pascal
   [Setup]
   AppName=Mon Application
   AppVersion=1.0
   DefaultDirName={pf}\MonApp
   DefaultGroupName=MonApp
   OutputDir=Output
   OutputBaseFilename=MonApp-Setup-1.0

   [Files]
   Source: "MonApp.exe"; DestDir: "{app}"
   Source: "README.txt"; DestDir: "{app}"

   [Icons]
   Name: "{group}\Mon Application"; Filename: "{app}\MonApp.exe"
   Name: "{group}\D√©sinstaller"; Filename: "{uninstallexe}"
   ```

3. **Compiler l'installateur** :
   ```cmd
   iscc setup.iss
   ```

#### Distribution portable

**Cr√©er un package portable** :
```batch
@echo off
:: BuildPortable.bat
set APP_NAME=MonApp  
set VERSION=1.0

:: Cr√©er structure
mkdir Portable\%APP_NAME%_%VERSION%  
mkdir Portable\%APP_NAME%_%VERSION%\Data

:: Copier fichiers
copy Release\%APP_NAME%.exe Portable\%APP_NAME%_%VERSION%\  
copy README.txt Portable\%APP_NAME%_%VERSION%\

:: Cr√©er launcher
echo @echo off > Portable\%APP_NAME%_%VERSION%\Run_%APP_NAME%.bat  
echo cd /d "%%~dp0" >> Portable\%APP_NAME%_%VERSION%\Run_%APP_NAME%.bat  
echo start %APP_NAME%.exe >> Portable\%APP_NAME%_%VERSION%\Run_%APP_NAME%.bat

:: Cr√©er ZIP
powershell Compress-Archive -Path "Portable\%APP_NAME%_%VERSION%" -DestinationPath "%APP_NAME%_%VERSION%_Portable.zip"
```

### Troubleshooting avanc√©

#### Analyse des crashs

**Utiliser les dumps Windows** :

1. **Activer la g√©n√©ration de dumps** :
   ```registry
   [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps]
   "DumpFolder"="C:\\Dumps"
   "DumpType"=dword:00000002
   ```

2. **Analyser avec WinDbg** :
   - Installer Windows SDK
   - Ouvrir le .dmp
   - Analyser la stack trace

#### Probl√®mes de DLL

**DLL manquantes courantes** :
- `msvcr120.dll` ‚Üí Visual C++ 2013 Redistributable
- `msvcp140.dll` ‚Üí Visual C++ 2015-2019 Redistributable
- `api-ms-win-*.dll` ‚Üí Windows Update n√©cessaire

**Outil de diagnostic** :
```cmd
# Voir les d√©pendances
dumpbin /dependents MonApp.exe

# Ou utiliser Dependency Walker
depends.exe MonApp.exe
```

### Automatisation et scripts

#### Build automatique avec script

**BuildAll.bat** complet :
```batch
@echo off
setlocal EnableDelayedExpansion

:: Configuration
set LAZARUS_DIR=C:\lazarus  
set FPC=%LAZARUS_DIR%\fpc\3.2.2\bin\x86_64-win64\fpc.exe  
set LAZBUILD=%LAZARUS_DIR%\lazbuild.exe  
set PROJECT_DIR=C:\Dev\Projects

:: Couleurs
set RED=[91m  
set GREEN=[92m  
set YELLOW=[93m  
set RESET=[0m

:: Header
echo %GREEN%========================================  
echo    Build Automatique Lazarus  
echo    %DATE% %TIME%  
echo ========================================%RESET%

:: Build tous les projets
for /d %%P in (%PROJECT_DIR%\*) do (
    if exist "%%P\*.lpi" (
        echo.
        echo %YELLOW%Building: %%~nP%RESET%
        echo ----------------------------------------

        :: Trouver le fichier .lpi
        for %%F in ("%%P\*.lpi") do (
            :: Build
            "%LAZBUILD%" "%%F" --build-all --build-mode=Release

            :: V√©rifier succ√®s
            if !errorlevel! == 0 (
                echo %GREEN%‚úì %%~nP construit avec succ√®s%RESET%
            ) else (
                echo %RED%‚úó Erreur lors du build de %%~nP%RESET%
            )
        )
    )
)

echo.  
echo %GREEN%========================================  
echo    Build termin√©  
echo ========================================%RESET%  
pause
```

#### Int√©gration continue avec GitHub Actions

**`.github/workflows/build.yml`** :
```yaml
name: Build Lazarus Project

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build-windows:
    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v2

    - name: Install Lazarus
      run: |
        choco install lazarus -y
        refreshenv

    - name: Build project
      run: |
        lazbuild MyProject.lpi --build-mode=Release

    - name: Upload artifact
      uses: actions/upload-artifact@v2
      with:
        name: windows-executable
        path: MyProject.exe
```

## Conclusion et prochaines √©tapes

### R√©capitulatif

Vous avez maintenant trois m√©thodes d'installation ma√Ætris√©es :

1. **Installateur classique** : Pour d√©buter rapidement
2. **Chocolatey** : Pour la gestion automatis√©e
3. **Portable** : Pour la flexibilit√© maximale

### Check-list post-installation

Avant de commencer √† d√©velopper, v√©rifiez :

- [ ] Lazarus d√©marre correctement
- [ ] Compilation d'un projet test r√©ussie
- [ ] D√©bogueur fonctionnel
- [ ] Antivirus configur√© avec exclusions
- [ ] Git install√© et configur√©
- [ ] Structure de dossiers cr√©√©e
- [ ] Premier projet "Hello World" ex√©cut√©

### Ressources Windows sp√©cifiques

**Documentation** :
- Wiki Lazarus section Windows
- Forums d√©di√©s Windows
- Tutoriels vid√©o YouTube

**Outils recommand√©s** :
- Process Monitor : Diagnostiquer les probl√®mes
- WinMerge : Comparer les fichiers
- 7-Zip : Gestion des archives
- Notepad++ : √âdition rapide

### Vers le d√©veloppement multi-plateforme

Maintenant que Lazarus est install√© sur Windows, vous pouvez :

1. **D√©velopper des applications Windows natives**
2. **Pr√©parer la cross-compilation vers Linux**
3. **Apprendre les sp√©cificit√©s Windows** (API, Registry, Services)
4. **Explorer les composants visuels**

La prochaine √©tape sera l'installation sur Ubuntu pour comprendre les diff√©rences et similitudes, puis la configuration de la cross-compilation pour cr√©er des applications vraiment multi-plateformes.

---

**Rappel important** : L'installation n'est que le d√©but. La vraie ma√Ætrise vient avec la pratique. N'h√©sitez pas √† exp√©rimenter, casser, r√©parer et apprendre. C'est la beaut√© du logiciel libre : vous avez le contr√¥le total !

‚è≠Ô∏è [Installation sur Ubuntu (apt, snap, compilation source)](/01-introduction-freepascal-lazarus/04.2-installation-ubuntu.md)
